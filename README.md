# Excel表格合并工具

一个简单易用的Python工具，用于合并多个具有相同表头的Excel文件，并自动重新生成第一列的递增序号。

**提供两种使用方式：**
- 🖥️ **图形界面版** - 简单直观，无需命令行操作
- ⌨️ **命令行版** - 适合批处理和自动化脚本

## 功能特点

✨ **自动合并** - 合并多个Excel文件到一个文件中
✨ **表头验证** - 自动检查所有文件的表头是否一致
✨ **序号重建** - 自动重新生成第一列的递增序号（从1开始）
✨ **友好提示** - 清晰的进度显示和错误提示
✨ **图形界面** - 直观易用的GUI界面

## 安装依赖

```bash
# 安装Python依赖
pip install -r requirements.txt

# Linux系统额外需要（如果使用图形界面）
sudo apt-get install python3-tk
```

## 使用方法

### 方法一：图形界面版（推荐）🖥️

最简单的方式，适合所有用户！

**快速启动：**

```bash
# Windows用户 - 双击运行
启动GUI.bat

# Linux/Mac用户
./启动GUI.sh

# 或直接运行Python脚本
python excel_merger_gui.py
```

**界面功能：**

1. **选择文件** 📁
   - 点击"➕ 选择Excel文件"按钮
   - 可一次选择多个Excel文件
   - 文件列表会显示所有已选文件
   - 支持随时清空列表重新选择

2. **设置输出** 💾
   - 输入输出文件名（默认：merged_result.xlsx）
   - 点击"📂 浏览"选择保存位置
   - 自动添加.xlsx扩展名

3. **开始合并** ✨
   - 点击"✨ 开始合并"按钮
   - 实时查看操作日志
   - 显示每个文件的加载状态
   - 合并完成后弹窗提示

4. **操作日志** 📋
   - 实时显示处理进度
   - 清晰的成功/错误提示
   - 显示合并统计信息

**GUI优势：**
- ✅ 无需记忆命令行参数
- ✅ 可视化显示已选文件列表
- ✅ 实时显示操作日志
- ✅ 友好的错误提示对话框
- ✅ 支持拖拽式文件选择
- ✅ 多线程处理不卡顿

### 方法二：命令行版 ⌨️

适合批处理和自动化场景。

**基本用法：**

```bash
python excel_merger.py <输出文件名> <输入文件1> <输入文件2> [输入文件3] ...
```

**示例：**

```bash
# 合并两个文件
python excel_merger.py merged.xlsx file1.xlsx file2.xlsx

# 合并多个文件
python excel_merger.py output.xlsx data1.xlsx data2.xlsx data3.xlsx data4.xlsx
```

### 使用示例文件测试

项目中包含了三个示例Excel文件用于测试：

```bash
# 创建示例文件
python create_examples.py

# 使用命令行合并
python excel_merger.py result.xlsx example1.xlsx example2.xlsx example3.xlsx

# 或使用图形界面
python excel_merger_gui.py
```

## 工作原理

1. **加载文件** - 读取所有指定的Excel文件
2. **验证表头** - 确保所有文件的表头完全一致
3. **合并数据** - 将所有文件的数据行合并到一起
4. **重建序号** - 自动为第一列生成从1开始的递增序号
5. **保存结果** - 将合并后的数据保存到新的Excel文件

## 要求

- 所有输入的Excel文件必须具有**完全相同的表头**
- 第一列通常是序号列，合并后会自动重新编号
- 支持 `.xlsx` 和 `.xls` 格式的Excel文件

## 示例场景

假设你有以下三个Excel文件，都包含学生信息：

**file1.xlsx:**
| 序号 | 姓名 | 年龄 | 成绩 |
|------|------|------|------|
| 1    | 张三 | 20   | 85   |
| 2    | 李四 | 21   | 90   |

**file2.xlsx:**
| 序号 | 姓名 | 年龄 | 成绩 |
|------|------|------|------|
| 1    | 王五 | 19   | 88   |
| 2    | 赵六 | 22   | 92   |

**file3.xlsx:**
| 序号 | 姓名 | 年龄 | 成绩 |
|------|------|------|------|
| 1    | 孙七 | 20   | 87   |

运行命令：
```bash
python excel_merger.py merged.xlsx file1.xlsx file2.xlsx file3.xlsx
```

**结果 merged.xlsx:**
| 序号 | 姓名 | 年龄 | 成绩 |
|------|------|------|------|
| 1    | 张三 | 20   | 85   |
| 2    | 李四 | 21   | 90   |
| 3    | 王五 | 19   | 88   |
| 4    | 赵六 | 22   | 92   |
| 5    | 孙七 | 20   | 87   |

## 错误处理

工具会自动检测并提示以下错误：

- ❌ 文件不存在
- ❌ 文件为空
- ❌ 表头不一致
- ❌ 文件读取错误
- ❌ 文件保存错误

## 技术栈

- Python 3.6+
- pandas - 数据处理
- openpyxl - Excel文件读写

## 许可证

MIT License

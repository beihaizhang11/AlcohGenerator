# Excel表格合并工具 - GUI使用指南 📊

本指南将帮助您快速上手使用图形界面版的Excel表格合并工具。

## 快速开始 🚀

### Windows用户
1. 双击 `启动GUI.bat` 文件
2. 等待程序启动

### Linux/Mac用户
1. 在终端运行：`./启动GUI.sh`
2. 或运行：`python3 excel_merger_gui.py`

## 界面说明 🖥️

### 主界面布局

```
┌─────────────────────────────────────────────┐
│      📊 Excel表格合并工具                    │
├─────────────────────────────────────────────┤
│                                             │
│  📁 选择要合并的Excel文件                    │
│  ┌───────────────────────────────────────┐  │
│  │ ➕ 选择文件  🗑️ 清空    已选: 0文件  │  │
│  ├───────────────────────────────────────┤  │
│  │ file1.xlsx                            │  │
│  │ file2.xlsx                            │  │
│  │ file3.xlsx                            │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  💾 输出设置                                 │
│  ┌───────────────────────────────────────┐  │
│  │ 输出文件名: [merged_result.xlsx] 📂   │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  📋 操作日志                                 │
│  ┌───────────────────────────────────────┐  │
│  │ 欢迎使用Excel表格合并工具！            │  │
│  │ 请选择要合并的Excel文件...             │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  ┌───────────────────────────────────────┐  │
│  │        ✨ 开始合并                      │  │
│  └───────────────────────────────────────┘  │
└─────────────────────────────────────────────┘
```

## 详细操作步骤 📝

### 步骤1：选择Excel文件

1. 点击 **"➕ 选择Excel文件"** 按钮
2. 在弹出的文件选择对话框中：
   - 按住 `Ctrl` 键（Windows）或 `Cmd` 键（Mac）可多选文件
   - 选择所有要合并的Excel文件（.xlsx或.xls格式）
3. 点击"打开"确认选择
4. 文件列表会显示所有已选文件的文件名
5. 右上角显示已选文件的数量

**提示：**
- 可以多次点击"选择文件"按钮添加更多文件
- 如果选错了，点击"🗑️ 清空列表"重新选择
- 所有文件必须具有相同的表头（列名）

### 步骤2：设置输出文件

1. 在 **"输出文件名"** 输入框中输入文件名
   - 默认为：`merged_result.xlsx`
   - 可以只输入文件名，程序会自动添加.xlsx扩展名
   - 也可以输入完整路径

2. 或点击 **"📂 浏览"** 按钮
   - 选择保存位置
   - 输入文件名
   - 点击"保存"

### 步骤3：开始合并

1. 确认已选择所有要合并的文件
2. 确认输出文件名正确
3. 点击 **"✨ 开始合并"** 按钮
4. 观察操作日志区域：
   ```
   ============================================================
   开始合并操作...
   ============================================================
   
   📂 正在加载 3 个文件...
   ✓ 表头: ['序号', '姓名', '年龄', '成绩']
   ✓ [1/3] file1.xlsx (3 行)
   ✓ [2/3] file2.xlsx (2 行)
   ✓ [3/3] file3.xlsx (4 行)
   
   🔄 正在合并数据...
   ✓ 已合并 3 个文件，共 9 行数据
   ✓ 已重新生成第一列序号: 从 1 到 9
   
   💾 正在保存到: merged_result.xlsx
   ✅ 保存成功！
   
   ============================================================
   ✨ 合并完成！
   ============================================================
   ```

5. 合并完成后会弹出成功对话框，显示：
   - 合并的文件数
   - 总行数
   - 输出文件位置

## 常见问题 ❓

### Q1: 为什么提示"表头不一致"？

**原因：** 您选择的Excel文件的列名（表头）不完全相同。

**解决方法：**
- 确保所有文件的第一行（表头行）完全一致
- 列名的顺序也必须相同
- 检查是否有多余的空格或特殊字符

**示例：**

❌ 错误（表头不一致）：
```
file1.xlsx: 序号 | 姓名 | 年龄 | 成绩
file2.xlsx: 编号 | 姓名 | 年龄 | 分数  ← 第一列和最后一列不同
```

✅ 正确（表头一致）：
```
file1.xlsx: 序号 | 姓名 | 年龄 | 成绩
file2.xlsx: 序号 | 姓名 | 年龄 | 成绩
```

### Q2: 第一列的序号是如何处理的？

**说明：** 工具会自动忽略原文件中第一列的序号，合并后重新生成从1开始的连续序号。

**示例：**

原文件：
```
file1.xlsx:
序号 | 姓名
1   | 张三
2   | 李四

file2.xlsx:
序号 | 姓名
1   | 王五
2   | 赵六
```

合并后：
```
merged.xlsx:
序号 | 姓名
1   | 张三
2   | 李四
3   | 王五
4   | 赵六
```

### Q3: 可以合并多少个文件？

**回答：** 理论上没有限制，但建议：
- 文件数量：不超过100个
- 单个文件大小：不超过50MB
- 总数据行数：不超过100万行

### Q4: 支持哪些Excel格式？

**支持的格式：**
- ✅ .xlsx（推荐）
- ✅ .xls（旧版Excel格式）

**不支持的格式：**
- ❌ .csv（CSV文件需要先转换为Excel格式）
- ❌ .xlsm（带宏的Excel文件）

### Q5: 程序卡住或无响应怎么办？

**可能原因：**
1. 文件太大，正在处理中（请耐心等待）
2. 文件损坏或格式错误
3. 磁盘空间不足

**解决方法：**
- 查看操作日志区域，确认处理进度
- 如果文件很大，可能需要几分钟处理时间
- 关闭程序重新尝试，使用较小的文件测试

### Q6: 如何确认合并是否成功？

**检查方法：**
1. 查看操作日志是否显示"✨ 合并完成！"
2. 弹出成功对话框
3. 到输出文件位置查看文件是否生成
4. 打开文件检查：
   - 数据行数 = 所有输入文件的行数之和
   - 第一列序号从1开始连续递增
   - 数据内容完整无误

## 错误信息说明 🚨

### ❌ 文件不存在
- **含义：** 选择的某个文件已被删除或移动
- **解决：** 重新选择文件

### ❌ 文件为空
- **含义：** 某个Excel文件没有数据
- **解决：** 检查文件内容，删除空文件

### ❌ 表头不一致
- **含义：** 文件的列名不相同
- **解决：** 确保所有文件的第一行完全相同

### ❌ 读取文件出错
- **含义：** 文件损坏或格式错误
- **解决：** 用Excel打开文件检查，另存为新文件再试

### ❌ 保存文件出错
- **含义：** 无法写入输出文件
- **解决：** 
  - 检查输出文件是否已打开（关闭它）
  - 检查磁盘空间是否足够
  - 检查是否有写入权限

## 快捷操作 ⚡

### 键盘快捷键
- `Ctrl + O`：选择文件（如果支持）
- `Ctrl + Q`：退出程序（如果支持）

### 提高效率的技巧
1. **批量选择文件：** 在文件选择对话框中按住Ctrl键可多选
2. **快速清空：** 使用"清空列表"按钮快速重新开始
3. **历史记录：** 输出文件名会记住上次的设置
4. **日志复制：** 可以从日志区域复制文本用于排错

## 技术支持 💡

如果遇到问题：
1. 查看操作日志中的错误信息
2. 参考本指南的"常见问题"部分
3. 使用示例文件测试功能是否正常
4. 检查Python和依赖包是否正确安装

---

**祝您使用愉快！** 🎉

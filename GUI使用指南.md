# Excel表格合并工具 - GUI使用指南 📊

本指南将帮助您快速上手使用图形界面版的Excel表格合并工具。

## 快速开始 🚀

### Windows用户
1. 双击 `启动GUI.bat` 文件
2. 等待程序启动

### Linux/Mac用户
1. 在终端运行：`./启动GUI.sh`
2. 或运行：`python3 excel_merger_gui.py`

## 新功能 ✨

- **拖拽支持**：可以直接拖拽Excel文件到窗口添加
- **自动输出**：合并后的文件自动保存到桌面
- **智能命名**：输出文件名格式为 `账单汇总_YYYYMMDD HH-MM-SS.xlsx`

## 界面说明 🖥️

### 主界面布局

```
┌─────────────────────────────────────────────┐
│      📊 Excel表格合并工具                    │
│    合并相同表头的Excel文件 | 输出到桌面       │
├─────────────────────────────────────────────┤
│                                             │
│  📁 选择要合并的Excel文件（支持拖拽）         │
│  ┌───────────────────────────────────────┐  │
│  │ ➕ 选择文件  🗑️ 清空    已选: 0文件  │  │
│  ├───────────────────────────────────────┤  │
│  │   🎯 拖拽Excel文件到此窗口即可添加     │  │
│  ├───────────────────────────────────────┤  │
│  │ file1.xlsx                            │  │
│  │ file2.xlsx                            │  │
│  │ file3.xlsx                            │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  📋 操作日志                                 │
│  ┌───────────────────────────────────────┐  │
│  │ 欢迎使用Excel表格合并工具！            │  │
│  │ 请选择或拖拽Excel文件到窗口...         │  │
│  │ 合并后的文件将自动保存到桌面           │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  ┌───────────────────────────────────────┐  │
│  │   ✨ 开始合并（自动保存到桌面）          │  │
│  └───────────────────────────────────────┘  │
└─────────────────────────────────────────────┘
```

## 详细操作步骤 📝

### 步骤1：添加Excel文件

#### 方法一：点击按钮选择
1. 点击 **"➕ 选择Excel文件"** 按钮
2. 在弹出的文件选择对话框中：
   - 按住 `Ctrl` 键（Windows）或 `Cmd` 键（Mac）可多选文件
   - 选择所有要合并的Excel文件（.xlsx或.xls格式）
3. 点击"打开"确认选择

#### 方法二：拖拽添加（推荐）
1. 打开文件管理器，找到要合并的Excel文件
2. 选中文件（可多选）
3. 直接拖拽到程序窗口内
4. 松开鼠标，文件自动添加到列表

**提示：**
- 可以多次添加文件
- 如果选错了，点击"🗑️ 清空列表"重新选择
- 所有文件必须具有相同的表头（列名）
- 右上角显示已选文件的数量

### 步骤2：开始合并

1. 确认已选择所有要合并的文件
2. 点击 **"✨ 开始合并（自动保存到桌面）"** 按钮
3. 观察操作日志区域：
   ```
   ============================================================
   开始合并操作...
   ============================================================
   
   📂 正在加载 3 个文件...
   ✓ 表头: ['序号', '姓名', '年龄', '成绩']
   ✓ [1/3] file1.xlsx (3 行)
   ✓ [2/3] file2.xlsx (2 行)
   ✓ [3/3] file3.xlsx (4 行)
   
   🔄 正在合并数据...
   ✓ 已合并 3 个文件，共 9 行数据
   ✓ 已重新生成第一列序号: 从 1 到 9
   
   💾 正在保存到: /home/用户/桌面/账单汇总_20260108 14-30-25.xlsx
   ✅ 保存成功！
   
   ============================================================
   ✨ 合并完成！
   ============================================================
   ```

4. 合并完成后会弹出成功对话框，显示：
   - 合并的文件数
   - 总行数
   - 输出文件位置

### 步骤3：查看结果

合并完成后，输出文件会自动保存到桌面，文件名格式为：
```
账单汇总_YYYYMMDD HH-MM-SS.xlsx
```

例如：`账单汇总_20260108 14-30-25.xlsx`

## 常见问题 ❓

### Q1: 为什么提示"表头不一致"？

**原因：** 您选择的Excel文件的列名（表头）不完全相同。

**解决方法：**
- 确保所有文件的第一行（表头行）完全一致
- 列名的顺序也必须相同
- 检查是否有多余的空格或特殊字符

**示例：**

❌ 错误（表头不一致）：
```
file1.xlsx: 序号 | 姓名 | 年龄 | 成绩
file2.xlsx: 编号 | 姓名 | 年龄 | 分数  ← 第一列和最后一列不同
```

✅ 正确（表头一致）：
```
file1.xlsx: 序号 | 姓名 | 年龄 | 成绩
file2.xlsx: 序号 | 姓名 | 年龄 | 成绩
```

### Q2: 第一列的序号是如何处理的？

**说明：** 工具会自动忽略原文件中第一列的序号，合并后重新生成从1开始的连续序号。

**示例：**

原文件：
```
file1.xlsx:
序号 | 姓名
1   | 张三
2   | 李四

file2.xlsx:
序号 | 姓名
1   | 王五
2   | 赵六
```

合并后：
```
账单汇总_20260108 14-30-25.xlsx:
序号 | 姓名
1   | 张三
2   | 李四
3   | 王五
4   | 赵六
```

### Q3: 拖拽功能不工作怎么办？

**可能原因：**
1. 缺少 `tkinterdnd2` 库

**解决方法：**
```bash
pip install tkinterdnd2
```

安装后重新启动程序即可。

### Q4: 文件保存到哪里了？

**回答：** 合并后的文件自动保存到桌面，文件名格式为 `账单汇总_YYYYMMDD HH-MM-SS.xlsx`。

如果找不到桌面：
- Windows: `C:\Users\用户名\Desktop` 或 `C:\Users\用户名\桌面`
- Mac: `/Users/用户名/Desktop`
- Linux: `/home/用户名/Desktop` 或 `/home/用户名/桌面`

### Q5: 支持哪些Excel格式？

**支持的格式：**
- ✅ .xlsx（推荐）
- ✅ .xls（旧版Excel格式）

**不支持的格式：**
- ❌ .csv（CSV文件需要先转换为Excel格式）
- ❌ .xlsm（带宏的Excel文件）

### Q6: 程序卡住或无响应怎么办？

**可能原因：**
1. 文件太大，正在处理中（请耐心等待）
2. 文件损坏或格式错误
3. 磁盘空间不足

**解决方法：**
- 查看操作日志区域，确认处理进度
- 如果文件很大，可能需要几分钟处理时间
- 关闭程序重新尝试，使用较小的文件测试

### Q7: 如何确认合并是否成功？

**检查方法：**
1. 查看操作日志是否显示"✨ 合并完成！"
2. 弹出成功对话框
3. 到桌面查看是否生成了新文件
4. 打开文件检查：
   - 数据行数 = 所有输入文件的行数之和
   - 第一列序号从1开始连续递增
   - 数据内容完整无误

## 错误信息说明 🚨

### ❌ 文件不存在
- **含义：** 选择的某个文件已被删除或移动
- **解决：** 重新选择文件

### ❌ 文件为空
- **含义：** 某个Excel文件没有数据
- **解决：** 检查文件内容，删除空文件

### ❌ 表头不一致
- **含义：** 文件的列名不相同
- **解决：** 确保所有文件的第一行完全相同

### ❌ 读取文件出错
- **含义：** 文件损坏或格式错误
- **解决：** 用Excel打开文件检查，另存为新文件再试

### ❌ 保存文件出错
- **含义：** 无法写入输出文件
- **解决：** 
  - 检查磁盘空间是否足够
  - 检查是否有写入权限

## 快捷操作 ⚡

### 提高效率的技巧
1. **拖拽添加：** 直接拖拽文件到窗口，比点击按钮更快
2. **批量选择：** 在文件选择对话框中按住Ctrl键可多选
3. **快速清空：** 使用"清空列表"按钮快速重新开始
4. **日志复制：** 可以从日志区域复制文本用于排错

## 技术支持 💡

如果遇到问题：
1. 查看操作日志中的错误信息
2. 参考本指南的"常见问题"部分
3. 使用示例文件测试功能是否正常
4. 检查Python和依赖包是否正确安装

---

**祝您使用愉快！** 🎉
